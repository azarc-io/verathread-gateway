replicas: 1
nodeSelector: {}
nameOverride: "gateway"
fullnameOverride: "gateway"
imagePullSecrets:
  - name: ghcr-login-secret
# if using traefik as your proxy
traefik: "yes"
# disables deployment of any proxy middle wares
middleware_enabled: "no"
# local dev mode
dev: false
# hmr for the front end
hmr: false
fileStorage:
  enabled: false
# Custom Service account management
serviceAccount:
  # Whether to create service account or not
  create: true
  # Name of the service account
  name: gateway-svc-account
image:
  # the gateway image
  repository: ghcr.io/azarc-io/verathread-gateway/gateway-be
  tag: v1.54.0
  # the web sidecar, if hmr is true then the sidecar will run node and build the web app
  # otherwise it will be a lightweight container that hosts the files on behalf of the gateway
  web_repository: ghcr.io/azarc-io/verathread-gateway/gateway-fe
  web_repository_tag: v1.54.0
  pullPolicy: Always
# port bindings
bind:
  http: &bindHttpPort 6010
  dapr_http_port: &daprHttpPort 3500
  dapr_grpc_port: &daprGrpcPort 50001
  dapr_health_check_port: 3500
  hmr: 3000
  debug: 40000
# labels to attach to all resources
commonLabels:
  verathread.com/scrape-logs: "true"
# pod annotations
annotations:
  dapr.io/enabled: "true"
  dapr.io/app-id: "gateway"
  dapr.io/app-port: "6010"
  dapr.io/config: "gateway-config"
  dapr.io/log-level: "warn"
  dapr.io/sidecar-image: ghcr.io/azarc-io/dapr:1.13.4-vth-linux-amd64
# handles routing, is split into two / for web and /graphql and /modules for api and static file proxy
ingress:
  # If `true`, an Ingress is created
  enabled: true
  # The Service port targeted by the Ingress
  servicePort: http
  # Ingress annotations
  annotations:
    traefik.ingress.kubernetes.io/buffering: |
      maxrequestbodybytes: 3750000
      memrequestbodybytes: 3750000
  # Additional Ingress labels
  labels: {}
  # List of rules for the Ingress
  rules:
    - host: dev.cluster.local
      service: gateway
      paths:
        - /graphql
        - /module
        - /api
    - host: dev.cluster.local
      service: gateway-web
      paths:
        - /
# Service configuration
configuration:
  name: gateway
  id: ${MICRO_SERVICE_ID}
  database:
    dsn: mongodb%3A%2F%2Fmongodb%3A27017%2F%3FreplicaSet%3Drs0%26tls%3Dfalse%26connect%3Ddirect%26retryWrites%3Dtrue%26w%3Dmajority
    name: vth-gateway
  auth:
    domain: "https://dev-iq3b9wdl.us.auth0.com"
    client_id: ""
    client_secret: ""
    jwt:
      auth_domain: https://auth.dev.cloud.azarc.dev
      aud: https://verathread.com/api/verify
      iss: https://verathread.com/
      claims: https://verathread.com/claims
  development:
    enabled: false
  logger:
    level: info
    mode: dev # or prd
  dapr:
    http_port: *daprHttpPort
    grpc_port: *daprGrpcPort
  gateway:
    web_dir: /web
    backoffice_org: org_hiUmCjtFR7ZgEckN
    web_proxy: ""
    http:
      address: ${BIND_ADDRESS}
      port: *bindHttpPort
      cors:
        allow_credentials: true
        allow_origins:
          - '*'
        allow_headers:
          - '*'
        allow_methods:
          - POST
          - GET
          - PUT
          - DELETE
          - PATCH
          - HEAD
    metrics:
      address: ${BIND_ADDRESS}
      port: 6015
    services: {}
# environment variables attached to the pod
extraEnvVars:
  BASE_CONTEXT: config
  CONFIG_DIR: /config
  DAPR_GRPC_PORT: *daprGrpcPort
  DAPR_HTTP_PORT: *daprHttpPort
  BIND_ADDRESS: 0.0.0.0
